<?xml version="1.0" encoding="utf-8"?>
<!--
æ–‡ä»¶è·¯å¾„ï¼šapp/src/main/AndroidManifest.xml
æ–‡ä»¶åï¼šAndroidManifest.xml
æ–‡ä»¶ç±»å‹ï¼šManifestï¼ˆåº”ç”¨æ¸…å•ï¼‰
çŠ¶æ€ï¼šâœ… å®Œæ•´ç‰ˆï¼ˆå¯ç›´æ¥ä½¿ç”¨ï¼‰
åˆ›å»ºæ—¥æœŸï¼š2025-10-15
æœ€åä¿®æ”¹ï¼š2025-10-28
ä½œè€…ï¼šClaude

åŠŸèƒ½è¯´æ˜ï¼š
1. å®šä¹‰åº”ç”¨æƒé™ï¼ˆç½‘ç»œè®¿é—®ï¼‰
2. æ³¨å†Œæ‰€æœ‰Activity
3. é…ç½®åº”ç”¨ä¸»é¢˜å’Œå…ƒæ•°æ®
4. è®¾ç½®Activityå¯¼èˆªå…³ç³»

æ³¨æ„ï¼š
- packageåç§°éœ€è¦æ›¿æ¢ä¸ºä½ çš„å®é™…åŒ…å
- å¦‚æœæœ‰å…¶ä»–Activityï¼Œè¯·ä¸€å¹¶æ·»åŠ 
-->

<manifest xmlns:android="http://schemas.android.com/apk/res/android"
    xmlns:tools="http://schemas.android.com/tools"
    package="com.example.nativechatdemo">

    <!-- ========================================
         æƒé™å£°æ˜
         ======================================== -->

    <!-- OpenAI APIéœ€è¦ç½‘ç»œè®¿é—®æƒé™ -->
    <uses-permission android:name="android.permission.INTERNET" />

    <!-- ç½‘ç»œçŠ¶æ€æ£€æŸ¥æƒé™ï¼ˆå¯é€‰ï¼Œç”¨äºæ£€æµ‹ç½‘ç»œè¿æ¥ï¼‰ -->
    <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />

    <!-- å†™å…¥å¤–éƒ¨å­˜å‚¨æƒé™ï¼ˆå¦‚æœéœ€è¦å¯¼å‡ºèŠå¤©è®°å½•ï¼‰ -->
    <!-- <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"
         android:maxSdkVersion="28" /> -->

    <!-- è¯»å–å¤–éƒ¨å­˜å‚¨æƒé™ï¼ˆå¦‚æœéœ€è¦å¯¼å…¥æ–‡ä»¶ï¼‰ -->
    <!-- <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE"
         android:maxSdkVersion="32" /> -->

    <application
        android:allowBackup="true"
        android:dataExtractionRules="@xml/data_extraction_rules"
        android:fullBackupContent="@xml/backup_rules"
        android:icon="@mipmap/ic_launcher"
        android:label="@string/app_name"
        android:roundIcon="@mipmap/ic_launcher_round"
        android:supportsRtl="true"
        android:theme="@style/Theme.NativeChatDemo"
        android:usesCleartextTraffic="true"
        tools:targetApi="31">

        <!-- ========================================
             è¯´æ˜ï¼šandroid:usesCleartextTraffic="true"
             å…è®¸HTTPæ˜æ–‡æµé‡ï¼ˆå¼€å‘é˜¶æ®µä½¿ç”¨ï¼‰
             ç”Ÿäº§ç¯å¢ƒå»ºè®®ç§»é™¤ï¼Œä½¿ç”¨HTTPS
             ======================================== -->

        <!-- ========================================
             MainActivity - åº”ç”¨ä¸»ç•Œé¢
             ======================================== -->
        <activity
            android:name=".MainActivity"
            android:exported="true"
            android:label="@string/app_name"
            android:theme="@style/Theme.NativeChatDemo">

            <!-- å¯åŠ¨å™¨å…¥å£ -->
            <intent-filter>
                <action android:name="android.intent.action.MAIN" />
                <category android:name="android.intent.category.LAUNCHER" />
            </intent-filter>
        </activity>

        <!-- ========================================
             CharacterConfigActivity - è§’è‰²é…ç½®ç•Œé¢
             ======================================== -->
        <activity
            android:name=".ui.character.CharacterConfigActivity"
            android:exported="false"
            android:label="@string/character_config_title"
            android:parentActivityName=".MainActivity"
            android:theme="@style/Theme.NativeChatDemo"
            android:windowSoftInputMode="adjustResize">

            <!-- è¿”å›å¯¼èˆª -->
            <meta-data
                android:name="android.support.PARENT_ACTIVITY"
                android:value=".MainActivity" />
        </activity>

        <!-- ========================================
             ChatActivity - èŠå¤©ç•Œé¢
             ======================================== -->
        <activity
            android:name=".ui.chat.ChatActivity"
            android:exported="false"
            android:label="@string/chat_loading"
            android:parentActivityName=".MainActivity"
            android:theme="@style/Theme.NativeChatDemo"
            android:windowSoftInputMode="adjustResize">

            <!-- è¿”å›å¯¼èˆª -->
            <meta-data
                android:name="android.support.PARENT_ACTIVITY"
                android:value=".MainActivity" />
        </activity>

        <!-- ========================================
             å…¶ä»–Activityï¼ˆå¦‚æœæœ‰ï¼Œè¯·æ·»åŠ åœ¨è¿™é‡Œï¼‰
             ======================================== -->

        <!-- ç¤ºä¾‹ï¼šè®¾ç½®ç•Œé¢ -->
        <!--
        <activity
            android:name=".ui.settings.SettingsActivity"
            android:exported="false"
            android:label="@string/settings"
            android:parentActivityName=".MainActivity"
            android:theme="@style/Theme.NativeChatDemo">

            <meta-data
                android:name="android.support.PARENT_ACTIVITY"
                android:value=".MainActivity" />
        </activity>
        -->

        <!-- ç¤ºä¾‹ï¼šè§’è‰²åˆ—è¡¨ç•Œé¢ -->
        <!--
        <activity
            android:name=".ui.character.CharacterListActivity"
            android:exported="false"
            android:label="æˆ‘çš„è§’è‰²"
            android:parentActivityName=".MainActivity"
            android:theme="@style/Theme.NativeChatDemo">

            <meta-data
                android:name="android.support.PARENT_ACTIVITY"
                android:value=".MainActivity" />
        </activity>
        -->

    </application>

</manifest>

<!--
========================================
ğŸ“‹ é…ç½®è¯´æ˜
========================================

1. æƒé™ï¼š
   - INTERNET: OpenAI APIè°ƒç”¨éœ€è¦
   - ACCESS_NETWORK_STATE: æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼ˆå¯é€‰ï¼‰
   - å…¶ä»–æƒé™æ ¹æ®éœ€è¦æ·»åŠ 

2. android:usesCleartextTraffic="true"ï¼š
   - å¼€å‘é˜¶æ®µå…è®¸HTTP
   - ç”Ÿäº§ç¯å¢ƒå»ºè®®ç§»é™¤ï¼Œåªä½¿ç”¨HTTPS
   - æˆ–è€…é…ç½®network_security_config.xml

3. android:windowSoftInputMode="adjustResize"ï¼š
   - é”®ç›˜å¼¹å‡ºæ—¶è°ƒæ•´å¸ƒå±€
   - èŠå¤©ç•Œé¢å’Œé…ç½®ç•Œé¢å¿…éœ€

4. parentActivityNameï¼š
   - å®šä¹‰è¿”å›å¯¼èˆªå…³ç³»
   - å·¥å…·æ è¿”å›æŒ‰é’®è‡ªåŠ¨æ˜¾ç¤º

5. android:exportedï¼š
   - MainActivity: trueï¼ˆå¯åŠ¨å…¥å£ï¼‰
   - å…¶ä»–Activity: falseï¼ˆä¸å…è®¸å¤–éƒ¨å¯åŠ¨ï¼‰

========================================
ğŸ”’ å®‰å…¨é…ç½®ï¼ˆå¯é€‰ï¼‰
========================================

å¦‚æœè¦é™åˆ¶HTTPæµé‡ï¼Œåˆ›å»ºï¼š
res/xml/network_security_config.xml

<?xml version="1.0" encoding="utf-8"?>
<network-security-config>
    <domain-config cleartextTrafficPermitted="false">
        <domain includeSubdomains="true">api.openai.com</domain>
    </domain-config>
</network-security-config>

ç„¶ååœ¨ <application> ä¸­æ·»åŠ ï¼š
android:networkSecurityConfig="@xml/network_security_config"

========================================
ğŸ“¦ æ•°æ®å¤‡ä»½è§„åˆ™ï¼ˆå¯é€‰ï¼‰
========================================

res/xml/backup_rules.xmlï¼ˆAndroid 12+ï¼‰ï¼š

<?xml version="1.0" encoding="utf-8"?>
<full-backup-content>
    <include domain="sharedpref" path="."/>
    <exclude domain="sharedpref" path="openai_config.xml"/>
</full-backup-content>

res/xml/data_extraction_rules.xmlï¼ˆAndroid 12+ï¼‰ï¼š

<?xml version="1.0" encoding="utf-8"?>
<data-extraction-rules>
    <cloud-backup>
        <include domain="sharedpref" path="."/>
        <exclude domain="sharedpref" path="openai_config.xml"/>
    </cloud-backup>
</data-extraction-rules>

è¯´æ˜ï¼š
- å¤‡ä»½SharedPreferences
- æ’é™¤API Keyé…ç½®ï¼ˆå®‰å…¨è€ƒè™‘ï¼‰

========================================
ğŸ’¡ å¸¸è§é—®é¢˜
========================================

Q1: æ‰¾ä¸åˆ°Activityç±»
A: æ£€æŸ¥packageåç§°æ˜¯å¦æ­£ç¡®ï¼Œç¡®ä¿ä¸å®é™…åŒ…åä¸€è‡´

Q2: ç½‘ç»œè¯·æ±‚å¤±è´¥
A: ç¡®è®¤å·²æ·»åŠ INTERNETæƒé™

Q3: é”®ç›˜é®æŒ¡è¾“å…¥æ¡†
A: ç¡®ä¿è®¾ç½®äº† windowSoftInputMode="adjustResize"

Q4: è¿”å›æŒ‰é’®ä¸æ˜¾ç¤º
A: ç¡®ä¿è®¾ç½®äº† parentActivityName å’Œ meta-data

Q5: HTTPè¯·æ±‚è¢«é˜»æ­¢
A: æ£€æŸ¥ usesCleartextTraffic æˆ–é…ç½® network_security_config

========================================
-->